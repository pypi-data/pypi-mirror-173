import{u as R,D as P,O as N,N as B,aJ as D,d as O,c as i,e as V,r as $,g as a,o as _,f as d,w as S,k as J,aK as L,aL as Q,aM as q,aN as F,aO as G,h as g,aG as H,aP as K,aD as M,a4 as A,aQ as W,t as j}from"./index.daad7f12.js";import{u as z}from"./useRouteParam.5959eb5e.js";import{u as T}from"./useSubscriptionWithDependencies.a52032cb.js";function E(t,e=""){var k;const p=R(),n=P(),y=C(e,(k=v(n,t))!=null?k:e),r=N(y),o=B(r,(s,l)=>{I(s,l)||p.push({query:{...n.query,[t]:r.value}})}),m=B(n,(s,l)=>{var u,c;const b=(u=v(s,t))!=null?u:e,h=(c=v(l,t))!=null?c:e,f=C(h,b);f!==r.value&&(r.value=f)},{deep:!0});return D(()=>{o(),m()}),r}function v({query:t},e){return t[e]}function C(t,e){return Array.isArray(t)&&!Array.isArray(e)?[e]:typeof t=="string"&&Array.isArray(e)?e[0]:e}function I(t,e){return JSON.stringify(t)===JSON.stringify(e)}const Z=O({__name:"BlocksCatalogCreate",setup(t){const e=R(),p=E("redirect"),n=z("blockTypeSlug"),y=i(()=>n.value?[n.value]:null),r=T(H.getBlockTypeBySlug,y),o=i(()=>r.response),m=i(()=>o.value?[o.value.id]:null),k=T(K.getBlockSchemaForBlockType,m),s=i(()=>k.response);function l(u){M.createBlockDocument(u).then(({id:c})=>h(c)).catch(c=>{A("Failed to create block","error"),console.error(c)})}function b(){e.back()}function h(u){if(A("Block created successfully","success"),p.value){const c=e.resolve(W(p.value));e.push(c);return}e.push(j.block(u))}const f=i(()=>o.value?`Create ${o.value.name} Block`:"Create Block");return V(f),(u,c)=>{const w=$("p-layout-default");return a(o)?(_(),d(w,{key:0,class:"blocks-catalog-create"},{header:S(()=>[J(a(L),{"block-type":a(o)},null,8,["block-type"])]),default:S(()=>[a(o)?(_(),d(a(Q),{key:0,"block-type":a(o)},{default:S(()=>[a(s)?(_(),d(a(q),F({key:0,key:a(s).id,"block-schema":a(s)},G({submit:l,cancel:b})),null,16,["block-schema"])):g("",!0)]),_:1},8,["block-type"])):g("",!0)]),_:1})):g("",!0)}}});export{Z as default};
