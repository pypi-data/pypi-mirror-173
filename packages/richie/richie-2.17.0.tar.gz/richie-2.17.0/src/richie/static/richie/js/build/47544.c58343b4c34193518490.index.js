"use strict";(self.webpackChunkrichie_education=self.webpackChunkrichie_education||[]).push([[47544],{47544:function(e,r,t){t.r(r),t.d(r,{default:function(){return Ke}}),t(39275),t(22321);var n=t(83277),a=t(89526),s=t(34323),o=t(56397),i=(t(3973),t(80044),t(26364),t(19701),t(10853),t(80238),t(6208),t(12938),t(26425),t(81081)),d=(t(31807),t(85005),t(67557)),c=["disabled"];function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function u(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){p(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function p(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var f=function(e){var r=e.disabled,t=void 0!==r&&r,n=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(e,c),a=["button"];n.color&&a.push("button--"+n.color),n.size&&a.push("button--"+n.size);var s={className:a.join(" "),disabled:t};return n.href&&!t?(0,d.jsx)("a",u(u(u({},s),n),{},{children:n.children})):(0,d.jsx)("button",u(u(u({},s),n),{},{children:n.children}))},b=(t(86632),t(61928),t(54883),t(45007),t(68995),t(18821),t(54994),t(4845),t(12524));function m(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,s=[],o=!0,i=!1;try{for(t=t.call(e);!(o=(n=t.next()).done)&&(s.push(n.value),!r||s.length!==r);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==t.return||t.return()}finally{if(i)throw a}}return s}}(e,r)||function(e,r){if(e){if("string"==typeof e)return h(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var y=function(e){var r=m((0,a.useState)(!0),2),t=r[0],n=r[1],s=(0,a.useRef)(null),o=m((0,a.useState)("auto"),2),i=o[0],c=o[1],l=(0,a.useMemo)((function(){var e=["dashboard-card"];return t?e.push("dashboard-card--opened"):e.push("dashboard-card--closed"),e}),[t]);return(0,d.jsxs)("div",{className:l.join(" "),children:[(0,d.jsxs)("header",{className:"dashboard-card__header",children:[(0,d.jsx)("div",{children:e.header}),(0,d.jsx)(f,{onClick:function(){t?(n(!1),c(s.current.getBoundingClientRect().height+"px"),setTimeout((function(){c("0")}))):(n(!0),c(s.current.getBoundingClientRect().height+"px"),s.current.parentNode.addEventListener("transitionend",(function(){c("auto")}),{once:!0}))},size:"nano",children:(0,d.jsx)(b.J,{name:"icon-chevron-down-outline","data-testid":"dashboard-card__header__toggle"})})]}),(0,d.jsx)("div",{className:"dashboard-card__wrapper",style:{height:i},"data-testid":"dashboard-card__wrapper",children:(0,d.jsxs)("div",{className:"dashboard-card__expandable",ref:s,children:[(0,d.jsx)("div",{className:"dashboard-card__content",children:e.children}),!!e.footer&&(0,d.jsx)("footer",{className:"dashboard-card__footer",children:e.footer})]})})]})},j=t(38136),v=t(43452),O=t(13959),g=t(87536),E=t(33515),x=t(80233),_=t(9976),C=t(95500);function D(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function P(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?D(Object(t),!0).forEach((function(r){R(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function R(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var S=(0,s.vU)({isMainInputLabel:{id:"hooks.useDashboardAddressForm.isMainInputLabel",defaultMessage:[{type:0,value:"Use this address as default"}]}}),w=function(e){var r,t,n,o,i,c,l,u,p,f,b=(0,s.YB)(),m={title:"",first_name:"",last_name:"",address:"",postcode:"",city:"",country:"-",is_main:!0},h=(0,g.cI)({defaultValues:m,mode:"onChange",reValidateMode:"onChange",resolver:(0,O.X)(x.Z)}),y=h.register,j=h.handleSubmit,v=h.reset,D=h.formState;return(0,a.useEffect)((function(){v(e||m)}),[e]),{FormView:(0,d.jsxs)("form",{children:[(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.title,"aria-required":!0,id:"title",label:b.formatMessage(E.sY.titleInputLabel),error:!!D.errors.title,message:(0,x.n)(b,null===(r=D.errors.title)||void 0===r?void 0:r.message)},y("title"))),(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.first_name,"aria-required":!0,id:"first_name",label:b.formatMessage(E.sY.first_nameInputLabel),error:!!D.errors.first_name,message:(0,x.n)(b,null===(t=D.errors.first_name)||void 0===t?void 0:t.message)},y("first_name"))),(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.last_name,"aria-required":!0,id:"last_name",label:b.formatMessage(E.sY.last_nameInputLabel),error:!!D.errors.last_name,message:(0,x.n)(b,null===(n=D.errors.last_name)||void 0===n?void 0:n.message)},y("last_name"))),(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.address,"aria-required":!0,id:"address",label:b.formatMessage(E.sY.addressInputLabel),error:!!D.errors.address,message:(0,x.n)(b,null===(o=D.errors.address)||void 0===o?void 0:o.message)},y("address"))),(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.postcode,"aria-required":!0,id:"postcode",label:b.formatMessage(E.sY.postcodeInputLabel),error:!!D.errors.postcode,message:(0,x.n)(b,null===(i=D.errors.postcode)||void 0===i?void 0:i.message)},y("postcode"))),(0,d.jsx)(_.nv,P({"aria-invalid":!!D.errors.city,"aria-required":!0,id:"city",label:b.formatMessage(E.sY.cityInputLabel),error:!!D.errors.city,message:(0,x.n)(b,null===(c=D.errors.city)||void 0===c?void 0:c.message)},y("city"))),(0,d.jsx)(C.A,P({"aria-invalid":!!D.errors.country,"aria-required":!1,id:"country",label:b.formatMessage(E.sY.countryInputLabel),error:!!D.errors.country,message:(0,x.n)(b,null===(l=D.errors.country)||void 0===l?void 0:l.message)},y("country",{value:"",required:!0}))),!(e&&e.is_main)&&(0,d.jsx)(_.ji,P({"aria-invalid":!(null===(u=D.errors)||void 0===u||!u.is_main),"aria-required":!1,id:"save",label:b.formatMessage(S.isMainInputLabel),error:!(null===(p=D.errors)||void 0===p||!p.is_main),message:(0,x.n)(b,null===(f=D.errors.is_main)||void 0===f?void 0:f.message)},y("is_main")))]}),handleSubmit:j}};function M(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function N(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?M(Object(t),!0).forEach((function(r){I(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function I(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var A,k,L,F=(0,s.vU)({header:{id:"components.DashboardCreateAddressForm.header",defaultMessage:[{type:0,value:"Create an address"}]},submit:{id:"components.DashboardCreateAddressForm.submit",defaultMessage:[{type:0,value:"Create"}]}}),T=function(e){var r=e.onSettled,t=w(),n=t.FormView,a=t.handleSubmit,o=(0,v.k)(),c=o.methods.create,l=o.states,u=l.error,p=l.isLoading;return(0,d.jsxs)(y,{header:(0,d.jsx)(s._H,N({},F.header)),footer:(0,d.jsx)(f,{color:"primary",onClick:a((function(e){c(e,{onSuccess:function(){null==r||r()}})})),children:(0,d.jsx)(s._H,N({},F.submit))}),children:[p&&(0,d.jsx)(j.$,{}),!p&&(0,d.jsxs)("div",{children:[u&&(0,d.jsx)(i.Z,{message:u,type:i.$.ERROR,rounded:!0}),n]})]})};function U(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t(55862),function(e){e.COURSES="/courses",e.COURSE="/courses/:code",e.PREFERENCES="/preferences",e.PREFERENCES_ADDRESS_EDITION="/preferences/addresses/:addressId",e.PREFERENCES_ADDRESS_CREATION="/preferences/addresses/create",e.PREFERENCES_CREDIT_CARD_EDITION="/preferences/credit-cards/:creditCardId"}(L||(L={}));var B,H=(0,s.vU)((U(A={},L.COURSES,{id:"components.Dashboard.DashboardRoutes.courses.path",defaultMessage:[{type:0,value:"/courses"}]}),U(A,L.COURSE,{id:"components.Dashboard.DashboardRoutes.course.path",defaultMessage:[{type:0,value:"/courses/"},{type:1,value:"code"}]}),U(A,L.PREFERENCES,{id:"components.Dashboard.DashboardRoutes.preferences.path",defaultMessage:[{type:0,value:"/preferences"}]}),U(A,L.PREFERENCES_ADDRESS_EDITION,{id:"components.Dashboard.DashboardRoutes.preferences.addresses.edition.path",defaultMessage:[{type:0,value:"/preferences/addresses/"},{type:1,value:"addressId"}]}),U(A,L.PREFERENCES_ADDRESS_CREATION,{id:"components.Dashboard.DashboardRoutes.preferences.addresses.creation.path",defaultMessage:[{type:0,value:"/preferences/addresses/create"}]}),U(A,L.PREFERENCES_CREDIT_CARD_EDITION,{id:"components.Dashboard.DashboardRoutes.preferences.creditCards.edition.path",defaultMessage:[{type:0,value:"/preferences/credit-cards/"},{type:1,value:"creditCardId"}]}),A)),Y=(0,s.vU)((U(k={},L.COURSES,{id:"components.Dashboard.DashboardRoutes.courses.label",defaultMessage:[{type:0,value:"My Courses"}]}),U(k,L.COURSE,{id:"components.Dashboard.DashboardRoutes.course.session.label",defaultMessage:[{type:0,value:"Course"}]}),U(k,L.PREFERENCES,{id:"components.Dashboard.DashboardRoutes.preferences.label",defaultMessage:[{type:0,value:"My preferences"}]}),U(k,L.PREFERENCES_ADDRESS_EDITION,{id:"components.Dashboard.DashboardRoutes.preferences.addresses.edition.label",defaultMessage:[{type:0,value:"Billing addresses"}]}),U(k,L.PREFERENCES_ADDRESS_CREATION,{id:"components.Dashboard.DashboardRoutes.preferences.addresses.creation.label",defaultMessage:[{type:0,value:"Billing addresses"}]}),U(k,L.PREFERENCES_CREDIT_CARD_EDITION,{id:"components.Dashboard.DashboardRoutes.preferences.creditCards.label",defaultMessage:[{type:0,value:"Credit cards"}]}),k));!function(e){e.PATH="path",e.LABEL="label"}(B||(B={}));var $=function(e){return function(r){return function(t){for(var n=e===B.LABEL?Y:H,a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return r.formatMessage.apply(r,[n[t]].concat(s))}}},q=$(B.LABEL),Z=$(B.PATH),V=function(){var e=We();return(0,d.jsx)(T,{onSettled:function(){return e(L.PREFERENCES)}})},J=t(74205);function X(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?X(Object(t),!0).forEach((function(r){W(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function W(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var G=(0,s.vU)({header:{id:"components.DashboardEditAddressForm.header",defaultMessage:[{type:0,value:'Edit address "'},{type:1,value:"title"},{type:0,value:'"'}]},submit:{id:"components.DashboardEditAddressForm.submit",defaultMessage:[{type:0,value:"Save updates"}]},remove:{id:"components.DashboardEditAddressForm.remove",defaultMessage:[{type:0,value:"Remove"}]}}),K=function(e){var r=e.address,t=e.onSettled,n=void 0===t?J.Z:t,a=w(r),o=a.FormView,c=a.handleSubmit,l=(0,v.k)(),u=l.methods,p=u.update,b=u.remove,m=l.states,h=m.error,O=m.isLoading;return(0,d.jsxs)(y,{header:(0,d.jsx)(s._H,z(z({},G.header),{},{values:{title:r.title}})),footer:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f,{color:"outline-primary",onClick:c((function(e){p(z(z({},r),e),{onSuccess:function(){null==n||n()}})})),children:(0,d.jsx)(s._H,z({},G.submit))}),!r.is_main&&(0,d.jsx)(f,{color:"outline-primary",onClick:function(){b(r,{onSuccess:function(){return n()}})},children:(0,d.jsx)(s._H,z({},G.remove))})]}),children:[O&&(0,d.jsx)(j.$,{}),!O&&(0,d.jsxs)("div",{children:[h&&(0,d.jsx)(i.Z,{message:h,type:i.$.ERROR,rounded:!0}),o]})]})},Q=t(93123),ee=["states"];var re=function(){var e=(0,n.UO)(),r=We(),t=(0,Q.J)(e.addressId),a=t.states,s=a.error,o=a.isLoading,c=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(t,ee);return(0,d.jsxs)(d.Fragment,{children:[o&&(0,d.jsx)(j.$,{}),s&&(0,d.jsx)(i.Z,{message:s,type:i.$.ERROR}),c.items.length>0&&(0,d.jsx)(K,{address:c.items[0],onSettled:function(){r(L.PREFERENCES)}})]})},te=(t(55281),t(73214),["header","footer"]);function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){se(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function se(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var oe=function(e){var r=e.header,t=e.footer,n=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(e,te);return(0,d.jsxs)("div",ae(ae({className:"dashboard-box"},n),{},{children:[!!r&&(0,d.jsx)("header",{className:"dashboard-box__header",children:r}),(0,d.jsx)("div",{className:"dashboard-box__content",children:n.children}),!!t&&(0,d.jsx)("footer",{className:"dashboard-box__footer",children:t})]}))};function ie(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function de(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ie(Object(t),!0).forEach((function(r){ce(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ie(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ce(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var le=(0,s.vU)({isMain:{id:"components.DashboardAddressBox.isMain",defaultMessage:[{type:0,value:"Default address"}]},delete:{id:"components.DashboardAddressBox.delete",defaultMessage:[{type:0,value:"Delete"}]},edit:{id:"components.DashboardAddressBox.edit",defaultMessage:[{type:0,value:"Edit"}]},setMain:{id:"components.DashboardAddressBox.setMain",defaultMessage:[{type:0,value:"Use by default"}]}}),ue=function(e){var r=e.address,t=e.promote,n=e.remove,a=e.edit;return(0,d.jsx)(oe,{"data-testid":"dashboard-address-box__"+r.id,header:r.is_main?(0,d.jsx)(s._H,de({},le.isMain)):null,footer:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"dashboard-address-box__buttons",children:[!r.is_main&&(0,d.jsx)(f,{color:"primary",onClick:function(){return t(r)},children:(0,d.jsx)(s._H,de({},le.setMain))}),(0,d.jsx)(f,{color:"primary",onClick:function(){return a(r)},children:(0,d.jsx)(s._H,de({},le.edit))})]}),!r.is_main&&(0,d.jsx)(f,{color:"primary",onClick:function(){return n(r)},children:(0,d.jsx)(s._H,de({},le.delete))})]}),children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h6",{className:"dashboard-address-box__title",children:r.title}),(0,d.jsx)("p",{className:"dashboard-address-box__identity",children:r.first_name+" "+r.last_name}),(0,d.jsxs)("p",{className:"dashboard-address-box__address",children:[r.address," - ",r.postcode," (",r.country,")"]})]})})},pe=["methods","states"];function fe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function be(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?fe(Object(t),!0).forEach((function(r){me(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function me(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var he,ye=(0,s.vU)({header:{id:"components.DashboardAddressesManagement.header",defaultMessage:[{type:0,value:"Billing addresses"}]},add:{id:"components.DashboardAddressesManagement.add",defaultMessage:[{type:0,value:"Add a new address"}]},error:{id:"components.DashboardAddressesManagement.error",defaultMessage:[{type:0,value:"An error occurred. Please retry later."}]},emptyList:{id:"components.DashboardAddressesManagement.emptyList",defaultMessage:[{type:0,value:"You haven't created any addresses yet."}]}}),je=function(e){var r=e.onClickCreate,t=e.onClickEdit,n=(0,s.YB)(),o=(0,v.k)(),c=o.methods,l=c.promote,u=c.remove,p=o.states,m=p.error,h=p.isLoading,O=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(o,pe),g=(0,a.useMemo)((function(){return O.items.sort((function(e,r){return e.is_main?-1:r.is_main?1:e.title.localeCompare(r.title,[n.locale,n.defaultLocale])}))}),[O.items]);return h?(0,d.jsx)(j.$,{}):(0,d.jsx)(y,{header:(0,d.jsx)(s._H,be({},ye.header)),children:(0,d.jsxs)("div",{className:"dashboard-addresses",children:[m&&(0,d.jsx)(i.Z,{message:m,type:i.$.ERROR,rounded:!0}),!m&&0===g.length&&(0,d.jsx)("p",{className:"dashboard-addresses__empty",children:(0,d.jsx)(s._H,be({},ye.emptyList))}),g.map((function(e){return(0,d.jsx)(ue,{address:e,edit:function(e){return null==t?void 0:t(e)},remove:u,promote:l},e.id)})),(0,d.jsxs)(f,{color:"outline-primary",onClick:function(){return null==r?void 0:r()},children:[(0,d.jsx)(b.J,{name:"icon-plus",className:"button__icon"}),(0,d.jsx)(s._H,be({},ye.add))]})]})})},ve=(t(24797),function(e){var r=e.creditCard;return(0,d.jsx)("div",{className:"credit-card-brand-logo",children:(0,d.jsx)("img",{alt:"",src:"/static/richie/images/components/DashboardCreditCardsManagement/logo_"+r.brand+".svg"})})});function Oe(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.EXPIRED="expired",e.SOON="soon",e.FINE="fine"}(he||(he={}));var ge=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,t;return r=e,t=[{key:"isExpiredSoon",value:function(e){if(!e.expiration_month||!e.expiration_year)return!1;var r=new Date(e.expiration_year,e.expiration_month-1,1),t=new Date;return t.setMonth(t.getMonth()+3),t.getTime()>r.getTime()}},{key:"isExpired",value:function(e){var r=new Date(e.expiration_year,e.expiration_month-1,1),t=new Date;return r.getTime()<t.getTime()}},{key:"getExpirationState",value:function(r){return e.isExpired(r)?he.EXPIRED:e.isExpiredSoon(r)?he.SOON:he.FINE}}],null&&Oe(r.prototype,null),t&&Oe(r,t),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Ee(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function xe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Ee(Object(t),!0).forEach((function(r){_e(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ee(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _e(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ce=(0,s.vU)({isMain:{id:"components.DashboardCreditCardBox.isMain",defaultMessage:[{type:0,value:"Default credit card"}]},endsWith:{id:"components.DashboardCreditCardBox.endsWith",defaultMessage:[{type:0,value:"Ends with •••• "},{type:1,value:"code"}]},expiration:{id:"components.DashboardCreditCardBox.expiration",defaultMessage:[{type:0,value:"Expires on "},{type:1,value:"month"},{type:0,value:"/"},{type:1,value:"year"}]},expired:{id:"components.DashboardCreditCardBox.expired",defaultMessage:[{type:0,value:"Expired since "},{type:1,value:"month"},{type:0,value:"/"},{type:1,value:"year"}]},delete:{id:"components.DashboardCreditCardBox.delete",defaultMessage:[{type:0,value:"Delete"}]},edit:{id:"components.DashboardCreditCardBox.edit",defaultMessage:[{type:0,value:"Edit"}]},setMain:{id:"components.DashboardCreditCardBox.setMain",defaultMessage:[{type:0,value:"Use by default"}]}}),De=function(e){var r=e.creditCard,t=e.promote,n=e.edit,o=e.remove,i=(0,a.useMemo)((function(){return ge.getExpirationState(r)}),[r]),c=i===he.EXPIRED?Ce.expired:Ce.expiration;return(0,d.jsx)(oe,{"data-testid":"dashboard-credit-card__"+r.id,header:r.is_main?(0,d.jsx)(s._H,xe({},Ce.isMain)):null,footer:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"dashboard-credit-card__buttons",children:[!r.is_main&&(0,d.jsx)(f,{color:"primary",onClick:function(){return t(r)},children:(0,d.jsx)(s._H,xe({},Ce.setMain))}),(0,d.jsx)(f,{color:"primary",onClick:function(){return n(r)},children:(0,d.jsx)(s._H,xe({},Ce.edit))})]}),!r.is_main&&(0,d.jsx)(f,{color:"primary",onClick:function(){return o(r)},children:(0,d.jsx)(s._H,xe({},Ce.delete))})]}),children:(0,d.jsxs)("div",{className:"dashboard-credit-card",children:[(0,d.jsx)("h6",{children:r.title}),(0,d.jsxs)("div",{className:"dashboard-credit-card__details",children:[(0,d.jsx)(ve,{creditCard:r}),(0,d.jsxs)("div",{className:"dashboard-credit-card__data",children:[(0,d.jsx)("p",{className:"dashboard-credit-card__brand",children:r.brand}),(0,d.jsxs)("div",{className:"dashboard-credit-card__meta",children:[(0,d.jsx)("p",{className:"dashboard-credit-card__code",children:(0,d.jsx)(s._H,xe(xe({},Ce.endsWith),{},{values:{code:r.last_numbers}}))}),(0,d.jsx)("p",{className:"dashboard-credit-card__meta__separator",children:"|"}),(0,d.jsxs)("p",{className:"dashboard-credit-card__expiration dashboard-credit-card__expiration--"+i,children:[i===he.EXPIRED&&(0,d.jsx)(b.J,{name:"icon-warning"}),(0,d.jsx)(s._H,xe(xe({},c),{},{values:{month:r.expiration_month.toLocaleString(void 0,{minimumIntegerDigits:2}),year:r.expiration_year}}))]})]})]})]})]})})},Pe=t(85011),Re=t(68919);function Se(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function we(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Se(Object(t),!0).forEach((function(r){Me(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Se(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function Me(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ne=(0,s.vU)({errorCannotRemoveMain:{id:"hooks.useCreditCardsManagement.errorCannotRemoveMain",defaultMessage:[{type:0,value:"Cannot remove main credit card."}]},deletionConfirmation:{id:"hooks.useCreditCardsManagement.deletionConfirmation",defaultMessage:[{type:0,value:"Are you sure you want to delete the credit card? ⚠️ You cannot undo this change after."}]}}),Ie=function(){var e=(0,s.YB)(),r=(0,Pe.r)();return we(we({},r),{},{methods:we(we({},r.methods),{},{safeDelete:function(t,n){t.is_main?r.methods.setError(e.formatMessage(Ne.errorCannotRemoveMain)):(0,Re.iG)(e.formatMessage(Ne.deletionConfirmation))&&r.methods.delete(t.id,n)}})})},Ae=["states","methods"];function ke(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Le(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ke(Object(t),!0).forEach((function(r){Fe(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ke(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function Fe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Te=(0,s.vU)({header:{id:"components.DashboardCreditCardsManagement.header",defaultMessage:[{type:0,value:"Credit cards"}]},errorCannotPromoteMain:{id:"components.DashboardCreditCardsManagement.errorCannotPromoteMain",defaultMessage:[{type:0,value:"Cannot promote main credit card."}]},emptyList:{id:"components.DashboardCreditCardsManagement.emptyList",defaultMessage:[{type:0,value:"You haven't created any credit cards yet."}]}}),Ue=function(e){var r=e.onClickEdit,t=(0,s.YB)(),n=Ie(),o=n.states,c=o.error,l=o.isLoading,u=n.methods,p=u.setError,f=u.update,b=u.safeDelete,m=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(n,Ae),h=function(e,r){var n;return e.is_main?-1:r.is_main?1:e.title?e.title.localeCompare(null!==(n=r.title)&&void 0!==n?n:"",[t.locale,t.defaultLocale]):1},v=(0,a.useMemo)((function(){return m.items.sort(h)}),[m.items]),O=function(e){e.is_main?p(t.formatMessage(Te.errorCannotPromoteMain)):f(Le(Le({},e),{},{is_main:!0}))};return(0,d.jsx)(y,{header:(0,d.jsx)(s._H,Le({},Te.header)),children:(0,d.jsxs)("div",{className:"dashboard-credit-cards",children:[l&&(0,d.jsx)(j.$,{}),!l&&(0,d.jsxs)(d.Fragment,{children:[c&&(0,d.jsx)(i.Z,{message:c,type:i.$.ERROR,rounded:!0}),!c&&0===v.length&&(0,d.jsx)("p",{className:"dashboard-credit-cards__empty",children:(0,d.jsx)(s._H,Le({},Te.emptyList))}),v.map((function(e){return(0,d.jsx)(De,{creditCard:e,edit:function(e){return null==r?void 0:r(e)},promote:O,remove:b},e.id)}))]})]})})},Be=function(){var e=We();return(0,d.jsxs)("div",{className:"dashboard-preferences",children:[(0,d.jsx)(je,{onClickCreate:function(){return e(L.PREFERENCES_ADDRESS_CREATION)},onClickEdit:function(r){return e(L.PREFERENCES_ADDRESS_EDITION,{addressId:r.id})}}),(0,d.jsx)(Ue,{onClickEdit:function(r){return e(L.PREFERENCES_CREDIT_CARD_EDITION,{creditCardId:r.id})}})]})},He=(t(42900),function(){var e=(0,n.TH)();return(0,n.SN)().find((function(r){return e.pathname===r.pathname}))});function Ye(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function $e(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Ye(Object(t),!0).forEach((function(r){qe(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ye(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function qe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ze=(0,s.vU)({header:{id:"components.DashboardEditCreditCard.header",defaultMessage:[{type:0,value:"Edit credit card"}]},submit:{id:"components.DashboardEditCreditCard.submit",defaultMessage:[{type:0,value:"Save updates"}]},delete:{id:"components.DashboardEditCreditCard.delete",defaultMessage:[{type:0,value:"Delete"}]},titleInputLabel:{id:"components.DashboardEditCreditCard.titleInputLabel",defaultMessage:[{type:0,value:"Name of the credit card"}]},lastNumbersInputLabel:{id:"components.DashboardEditCreditCard.lastNumbersInputLabel",defaultMessage:[{type:0,value:"Numbers"}]},expirationInputLabel:{id:"components.DashboardEditCreditCard.expirationInputLabel",defaultMessage:[{type:0,value:"Expiration"}]},isMainInputLabel:{id:"components.DashboardEditCreditCard.isMainInputLabel",defaultMessage:[{type:0,value:"Use this credit card as default"}]}}),Ve=function(e){var r,t,n,o,c=e.creditCard,l=e.onSettled,u=void 0===l?J.Z:l,p=(0,s.YB)(),b=Ie(),m=b.methods,h=m.update,v=m.safeDelete,O=b.states,E=O.isLoading,C=O.error,D=(0,g.cI)({defaultValues:{title:"",last_numbers:"",expiration:"",is_main:!0},mode:"onChange",reValidateMode:"onChange"}),P=D.register,R=D.handleSubmit,S=D.reset,w=D.formState;return(0,a.useEffect)((function(){S($e($e({},c),{},{expiration:c.expiration_month+"/"+c.expiration_year,last_numbers:"•••• ••••  ••••  "+c.last_numbers}))}),[c]),(0,d.jsx)(y,{header:(0,d.jsx)(s._H,$e({},Ze.header)),footer:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f,{color:"outline-primary",onClick:R((function(e){h($e($e({},c),{},{title:e.title,is_main:e.is_main}),{onSuccess:function(){u()}})})),children:(0,d.jsx)(s._H,$e({},Ze.submit))}),!c.is_main&&(0,d.jsx)(f,{color:"outline-primary",onClick:function(){return v(c,{onSuccess:function(){u()}})},children:(0,d.jsx)(s._H,$e({},Ze.delete))})]}),children:E?(0,d.jsx)(j.$,{}):C?(0,d.jsx)(i.Z,{message:C,type:i.$.ERROR,rounded:!0}):(0,d.jsxs)("form",{children:[(0,d.jsx)(_.nv,$e({"aria-invalid":!!w.errors.title,id:"title",label:p.formatMessage(Ze.titleInputLabel),error:!!w.errors.title,message:(0,x.n)(p,null===(r=w.errors.title)||void 0===r?void 0:r.message)},P("title"))),(0,d.jsxs)("div",{className:"dashboard-edit-credit-card__sensitive",children:[(0,d.jsx)(_.nv,$e({id:"last_numbers",disabled:!0,label:p.formatMessage(Ze.lastNumbersInputLabel)},P("last_numbers"))),(0,d.jsxs)("div",{className:"dashboard-edit-credit-card__sensitive__sub",children:[(0,d.jsx)(ve,{creditCard:c}),(0,d.jsx)(_.nv,$e({size:8,id:"expiration",disabled:!0,label:p.formatMessage(Ze.expirationInputLabel)},P("expiration")))]})]}),!c.is_main&&(0,d.jsx)(_.ji,$e({"aria-invalid":!(null===(t=w.errors)||void 0===t||!t.is_main),"aria-required":!1,id:"is_main",label:p.formatMessage(Ze.isMainInputLabel),error:!(null===(n=w.errors)||void 0===n||!n.is_main),message:(0,x.n)(p,null===(o=w.errors.is_main)||void 0===o?void 0:o.message)},P("is_main")))]})})},Je=["states"];var Xe=function(){var e=(0,n.UO)(),r=We(),t=(0,Pe.r)(e.creditCardId),a=t.states,s=a.error,o=a.isLoading,c=function(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(t,Je);return o?(0,d.jsx)(j.$,{}):s?(0,d.jsx)(i.Z,{message:s,type:i.$.ERROR}):c.items.length>0?(0,d.jsx)(Ve,{creditCard:c.items[0],onSettled:function(){return r(L.PREFERENCES)}}):(0,d.jsx)("div",{})},ze=(t(67838),function(e){var r=e.title,t=He();return(0,d.jsxs)("div",{"data-testid":"RouteInfo-".concat(t.pathname),children:[(0,d.jsx)("h1",{children:r}),(0,d.jsxs)("dl",{children:[(0,d.jsx)("dt",{children:"Route information :"}),(0,d.jsx)("dd",{children:(0,d.jsx)("pre",{children:JSON.stringify(t,null,2)})})]})]})}),We=function(){var e=Z((0,s.YB)()),r=(0,n.s0)();return(0,a.useMemo)((function(){return function(t,n,a,s){return"number"==typeof t?r(t):r(e(t,n,a),s)}}),[])},Ge=t(3497),Ke=function(e){var r,t,i=e.router,c=(0,Ge.k)().user,l=null!=i?i:(t=(0,s.YB)(),(0,o.aj)(function(){var e=(0,s.YB)(),r=Z(e),t=q(e);return[{path:"/",element:(0,d.jsx)(n.j3,{}),children:[{index:!0,element:(0,d.jsx)(n.Fg,{to:r(L.COURSES),replace:!0})},{path:r(L.COURSES),element:(0,d.jsx)(ze,{title:t(L.COURSES)}),handle:{crumbLabel:t(L.COURSES)}},{path:r(L.COURSE,{code:":code"}),element:(0,d.jsx)(ze,{title:t(L.COURSE)}),handle:{crumbLabel:t(L.COURSE)}},{path:r(L.PREFERENCES),handle:{name:t(L.PREFERENCES)},element:(0,d.jsx)(n.j3,{}),children:[{index:!0,element:(0,d.jsx)(Be,{}),handle:{crumbLabel:t(L.PREFERENCES)}},{path:r(L.PREFERENCES_ADDRESS_EDITION,{addressId:":addressId"}),element:(0,d.jsx)(re,{}),handle:{crumbLabel:t(L.PREFERENCES_ADDRESS_EDITION)}},{path:r(L.PREFERENCES_ADDRESS_CREATION),element:(0,d.jsx)(V,{}),handle:{crumbLabel:t(L.PREFERENCES_ADDRESS_CREATION)}},{path:r(L.PREFERENCES_CREDIT_CARD_EDITION,{creditCardId:":creditCardId"}),element:(0,d.jsx)(Xe,{}),handle:{crumbLabel:t(L.PREFERENCES_CREDIT_CARD_EDITION)}}]}]}]}(),{basename:(r=t.locale,"/".concat(r.split(/[-_]/)[0],"/dashboard"))}));return(0,a.useEffect)((function(){c||Re.xh.replace("/")}),[c]),c?(0,d.jsx)(n.pG,{router:l}):null}}}]);
//# sourceMappingURL=47544.c58343b4c34193518490.index.js.map